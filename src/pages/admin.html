<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plan de Acción Institucional - Administración</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <style type="text/tailwindcss">
    :root {
      --primary-color: #4f46e5;
      --secondary-color: #f0f2f4;
      --text-primary: #111827;
      --text-secondary: #6b7280;
      --background-color: #f9fafb;
    }
    body {
      font-family: 'Inter', 'Roboto', sans-serif;
    }
    details[open] summary .chevron {
      transform: rotate(90deg);
    }
    .chevron {
      transition: transform 0.2s ease;
    }
  </style>
  <link rel="stylesheet" href="../styles/sidebar.css">
  <link rel="stylesheet" href="../styles/layout.css">
  <link rel="stylesheet" href="../styles/loader.css">
</head>
<body class="bg-[var(--background-color)]">
  <div id="app-admin" class="h-full min-h-screen w-full flex-col">
    <div class="flex-1">
      <div class="layout-with-sidebar">
        <div id="shared-sidebar" class="hidden md:block"></div>
        <main class="p-4 sm:p-6 md:p-8">
          <div class="mx-auto max-w-7xl space-y-8">
            <header class="flex flex-col gap-2">
              <p class="text-sm uppercase tracking-wider text-indigo-600">Centro de Administración</p>
              <h1 class="text-3xl font-bold text-[var(--text-primary)]">Herramientas de Gestión</h1>
              <p class="text-[var(--text-secondary)] text-sm sm:text-base max-w-3xl">
                Desde este panel puedes mantener sincronizados los catálogos de apoyo, actualizar actividades existentes
                y revisar registros de avance sin salir del entorno de trabajo. Usa las secciones siguientes para acceder a cada módulo.
              </p>
            </header>

            <details class="rounded-lg border border-gray-200 bg-white shadow-sm">
              <summary class="flex cursor-pointer select-none items-center justify-between gap-4 px-6 py-4 text-lg font-semibold text-[var(--text-primary)]">
                <div class="flex items-center gap-3">
                  <span class="material-icons text-indigo-500">inventory_2</span>
                  Catálogo unificado
                </div>
                <span class="material-icons chevron text-gray-500">chevron_right</span>
              </summary>
              <div class="border-t border-gray-100 p-6 space-y-6 usuarios-panel-body">
                <section class="space-y-4">
                  <h2 class="text-xl font-semibold text-[var(--text-primary)]">Gestión del catálogo</h2>
                  <p class="text-sm text-[var(--text-secondary)] max-w-3xl">
                    Carga, crea o edita las entradas del catálogo unificado (áreas, subprocesos, estrategias, indicadores, etc.).
                    Los cambios se reflejan directamente sobre la hoja de cálculo conectada al backend.
                  </p>
                  <div class="grid gap-4 lg:grid-cols-[280px,1fr]">
                    <div class="space-y-3 rounded-lg border border-gray-200 bg-gray-50 p-4">
                      <label class="block text-sm font-medium text-[var(--text-secondary)]" for="catalogo-tipo">
                        Tipo de catálogo
                      </label>
                      <select id="catalogo-tipo" class="w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="">Selecciona tipo...</option>
                      </select>
                      <div class="grid gap-2 sm:grid-cols-2">
                        <button id="catalogo-tipo-crear" type="button" class="flex w-full items-center justify-center gap-2 rounded-md border border-dashed border-indigo-200 bg-white px-4 py-2 text-sm font-semibold text-indigo-600 transition hover:border-indigo-400 hover:bg-indigo-50">
                          <span class="material-icons text-base">add</span>
                          Nuevo tipo
                        </button>
                        <button id="catalogo-refrescar" class="flex w-full items-center justify-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                          <span class="material-icons text-base">refresh</span>
                          Cargar catálogo
                        </button>
                      </div>
                    </div>
                    <div class="space-y-4">
                      <div class="flex flex-wrap items-center justify-between gap-3">
                        <h3 class="text-lg font-semibold text-[var(--text-primary)]">Listado</h3>
                        <div class="flex items-center gap-2 text-sm text-[var(--text-secondary)]">
                          <span id="catalogo-contador">0 elementos</span>
                          <button id="catalogo-exportar" class="inline-flex items-center gap-1 rounded-md border border-gray-200 px-3 py-1.5 text-xs font-medium text-gray-600 transition hover:border-indigo-300 hover:text-indigo-600">
                            <span class="material-icons text-sm">download</span>
                            Exportar JSON
                          </button>
                        </div>
                      </div>
                      <div class="overflow-x-auto rounded-lg border border-gray-200">
                        <table class="min-w-full divide-y divide-gray-200 text-sm" id="catalogo-tabla">
                          <thead class="bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500">
                            <tr>
                              <th class="px-4 py-2 text-left">Codigo</th>
                              <th class="px-4 py-2 text-left">Nombre</th>
                              <th class="px-4 py-2 text-left">Padre</th>
                              <th class="px-4 py-2 text-left">Orden</th>
                              <th class="px-4 py-2 text-left">Estado</th>
                              <th class="px-4 py-2 text-left">Actualizado</th>
                              <th class="px-4 py-2 text-right">Acciones</th>
                            </tr>
                          </thead>
                          <tbody class="divide-y divide-gray-200 bg-white" id="catalogo-tabla-body">
                            <tr>
                              <td colspan="7" class="px-4 py-6 text-center text-sm text-gray-500">
                                Selecciona un tipo y presiona "Cargar catalogo".
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </section>

                <section class="rounded-lg border border-gray-200 bg-gray-50 p-6">
                  <form id="catalogo-form" class="grid gap-4 md:grid-cols-2">
                    <input type="hidden" id="catalogo-id" />
                    <div class="md:col-span-2 flex items-center justify-between">
                      <h3 class="text-lg font-semibold text-[var(--text-primary)]" id="catalogo-form-titulo">Agregar entrada</h3>
                      <button type="button" id="catalogo-form-reset" class="flex items-center gap-2 rounded-md border border-transparent px-3 py-1.5 text-xs font-medium text-gray-500 hover:text-indigo-600">
                        <span class="material-icons text-base">restart_alt</span>
                        Limpiar
                      </button>
                    </div>
                    <div class="md:col-span-2 grid gap-3 md:grid-cols-2">
                      <div>
                        <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="catalogo-id-display">Identificador</label>
                        <input id="catalogo-id-display" type="text" readonly class="mt-1 w-full rounded-md border-gray-200 bg-gray-100 text-sm shadow-sm" placeholder="Se genera automaticamente" />
                      </div>
                      <div>
                        <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="catalogo-updated-at">Ultima actualizacion</label>
                        <input id="catalogo-updated-at" type="text" readonly class="mt-1 w-full rounded-md border-gray-200 bg-gray-100 text-sm shadow-sm" placeholder="Pendiente" />
                      </div>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="catalogo-code">Codigo</label>
                      <input id="catalogo-code" name="code" type="text" required class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="catalogo-label">Nombre</label>
                      <input id="catalogo-label" name="label" type="text" required class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Nombre descriptivo" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="catalogo-parent">Codigo padre (opcional)</label>
                      <input id="catalogo-parent" name="parent_code" type="text" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Relaciona jerarquia" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="catalogo-sort-order">Orden</label>
                      <input id="catalogo-sort-order" name="sort_order" type="number" min="0" step="1" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Auto" />
                    </div>
                    <div class="md:col-span-2 flex items-center gap-2">
                      <input id="catalogo-activo" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-[var(--primary-color)] focus:ring-indigo-500" checked />
                      <label for="catalogo-activo" class="text-sm text-[var(--text-secondary)]">Activo</label>
                    </div>
                    <div class="md:col-span-2 flex flex-wrap items-center justify-between gap-3">
                      <div class="text-xs text-[var(--text-secondary)]" id="catalogo-form-status"></div>
                      <div class="flex gap-3">
                        <button type="submit" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                          <span class="material-icons text-base">save</span>
                          Guardar cambios
                        </button>
                        <button type="button" id="catalogo-eliminar" class="hidden items-center gap-2 rounded-md border border-red-200 bg-white px-4 py-2 text-sm font-semibold text-red-500 shadow-sm transition hover:border-red-300 hover:text-red-600">
                          <span class="material-icons text-base">delete</span>
                          Eliminar
                        </button>
                      </div>
                    </div>
                  </form>
                </section>
              </div>
            </details>

            <details class="rounded-lg border border-gray-200 bg-white shadow-sm" id="panel-presupuestos">
              <summary class="flex cursor-pointer select-none items-center justify-between gap-4 px-6 py-4 text-lg font-semibold text-[var(--text-primary)]">
                <div class="flex items-center gap-3">
                  <span class="material-icons text-indigo-500">account_balance</span>
                  Presupuestos por área
                </div>
                <span class="material-icons chevron text-gray-500">chevron_right</span>
              </summary>
              <div class="border-t border-gray-100 p-6 space-y-6 presupuestos-panel-body">
                <section class="space-y-4">
                  <div class="flex flex-wrap items-center justify-between gap-3">
                    <div>
                      <h2 class="text-xl font-semibold text-[var(--text-primary)]">Presupuesto de áreas</h2>
                      <p class="text-sm text-[var(--text-secondary)] max-w-3xl">
                        Administra los topes de la hoja <strong>Presupuesto_Area</strong>. Puedes crear nuevas versiones por vigencia,
                        marcar presupuestos vigentes y mantener un historial de modificaciones directamente desde este panel.
                      </p>
                    </div>
                    <div class="flex flex-wrap items-center justify-end gap-2">
                      <button id="presupuestos-recargar" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                        <span class="material-icons text-base">refresh</span>
                        Actualizar listado
                      </button>
                      <button id="presupuestos-limpiar-filtros" class="inline-flex items-center gap-2 rounded-md border border-gray-200 px-4 py-2 text-sm font-semibold text-gray-600 shadow-sm transition hover:border-indigo-300 hover:text-indigo-600">
                        <span class="material-icons text-base">filter_alt_off</span>
                        Limpiar filtros
                      </button>
                    </div>
                  </div>

                  <div class="grid gap-3 md:grid-cols-2 lg:grid-cols-4">
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuestos-area-filtro">Área</label>
                      <select id="presupuestos-area-filtro" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="">Todas las áreas</option>
                      </select>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuestos-vigencia-filtro">Vigencia</label>
                      <input id="presupuestos-vigencia-filtro" type="number" inputmode="numeric" placeholder="YYYY" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuestos-estado-filtro">Estado</label>
                      <select id="presupuestos-estado-filtro" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="">Todos los estados</option>
                        <option value="Propuesto">Propuesto</option>
                        <option value="Aprobado">Aprobado</option>
                        <option value="Modificado">Modificado</option>
                        <option value="Suspendido">Suspendido</option>
                        <option value="Cerrado">Cerrado</option>
                      </select>
                    </div>
                    <div class="flex items-center gap-2 rounded-md border border-gray-200 bg-gray-50 px-3 py-2">
                      <input id="presupuestos-actual-filtro" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-[var(--primary-color)] focus:ring-indigo-500" />
                      <label for="presupuestos-actual-filtro" class="text-sm text-[var(--text-secondary)]">Solo presupuestos vigentes (es_actual)</label>
                    </div>
                  </div>

                  <div class="flex flex-wrap items-center gap-3">
                    <label class="text-sm font-medium text-[var(--text-secondary)]" for="presupuestos-buscar">Buscar</label>
                    <input id="presupuestos-buscar" type="search" placeholder="Por código, área o vigencia" class="flex-1 min-w-[220px] rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    <span class="text-xs text-[var(--text-secondary)]" id="presupuestos-resumen">0 presupuestos</span>
                  </div>

                  <div class="overflow-x-auto rounded-lg border border-gray-200">
                    <table class="min-w-full divide-y divide-gray-200 text-sm" id="presupuestos-tabla">
                      <thead class="bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500">
                        <tr>
                          <th class="px-3 py-2 text-left">Código</th>
                          <th class="px-3 py-2 text-left">Área</th>
                          <th class="px-3 py-2 text-left">Vigencia</th>
                          <th class="px-3 py-2 text-left">Versión</th>
                          <th class="px-3 py-2 text-left">Presupuesto</th>
                          <th class="px-3 py-2 text-left">Estado</th>
                          <th class="px-3 py-2 text-left">Vigencia del registro</th>
                          <th class="px-3 py-2 text-left">Actual</th>
                          <th class="px-3 py-2 text-right">Acciones</th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-200 bg-white" id="presupuestos-tabla-body">
                        <tr>
                          <td colspan="9" class="px-4 py-6 text-center text-sm text-gray-500">
                            Presiona "Actualizar listado" para consultar los presupuestos disponibles.
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </section>

                <section class="rounded-lg border border-gray-200 bg-gray-50 p-6">
                  <form id="presupuestos-form" class="grid gap-4 md:grid-cols-2">
                    <input type="hidden" id="presupuesto-id" />
                    <div class="md:col-span-2 flex flex-wrap items-center justify-between gap-2">
                      <h3 class="text-lg font-semibold text-[var(--text-primary)]" id="presupuesto-form-titulo">Registrar presupuesto de área</h3>
                      <div class="flex gap-2">
                        <button type="button" id="presupuesto-limpiar" class="inline-flex items-center gap-2 rounded-md border border-transparent px-3 py-1.5 text-xs font-medium text-gray-500 hover:text-indigo-600">
                          <span class="material-icons text-base">restart_alt</span>
                          Limpiar
                        </button>
                      </div>
                    </div>

                    <div class="md:col-span-2 grid gap-3 md:grid-cols-3">
                      <div>
                        <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-id-display">Código</label>
                        <input id="presupuesto-id-display" type="text" readonly class="mt-1 w-full rounded-md border-gray-200 bg-gray-100 text-sm shadow-sm" placeholder="Se genera automáticamente" />
                      </div>
                      <div>
                        <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-registrado-por">Registrado por</label>
                        <input id="presupuesto-registrado-por" type="text" readonly class="mt-1 w-full rounded-md border-gray-200 bg-gray-100 text-sm shadow-sm" placeholder="Se completará al guardar" />
                      </div>
                      <div>
                        <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-registrado-en">Registrado en</label>
                        <input id="presupuesto-registrado-en" type="text" readonly class="mt-1 w-full rounded-md border-gray-200 bg-gray-100 text-sm shadow-sm" placeholder="Se completará al guardar" />
                      </div>
                    </div>

                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-area-id">Área</label>
                      <select id="presupuesto-area-id" required class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="">Selecciona un área...</option>
                      </select>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-vigencia">Vigencia</label>
                      <input id="presupuesto-vigencia" type="number" inputmode="numeric" min="2000" max="2099" required class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="YYYY" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-version">Versión</label>
                      <input id="presupuesto-version" type="number" inputmode="numeric" min="1" step="1" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Auto" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-asignado">Presupuesto asignado</label>
                      <input id="presupuesto-asignado" type="number" inputmode="decimal" min="0" step="0.01" required class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="0" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-moneda">Moneda</label>
                      <input id="presupuesto-moneda" type="text" maxlength="5" class="mt-1 w-full uppercase rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" value="COP" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-fuente">Fuente presupuestal</label>
                      <input id="presupuesto-fuente" type="text" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Opcional" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-estado">Estado</label>
                      <select id="presupuesto-estado" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="Propuesto">Propuesto</option>
                        <option value="Aprobado">Aprobado</option>
                        <option value="Modificado">Modificado</option>
                        <option value="Suspendido">Suspendido</option>
                        <option value="Cerrado">Cerrado</option>
                      </select>
                    </div>
                    <div class="flex items-center gap-2">
                      <input id="presupuesto-es-actual" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-[var(--primary-color)] focus:ring-indigo-500" />
                      <label for="presupuesto-es-actual" class="text-sm text-[var(--text-secondary)]">Marcar como presupuesto vigente</label>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-valido-desde">Válido desde</label>
                      <input id="presupuesto-valido-desde" type="date" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-valido-hasta">Válido hasta</label>
                      <input id="presupuesto-valido-hasta" type="date" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div class="md:col-span-2">
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-doc">URL del soporte (opcional)</label>
                      <input id="presupuesto-doc" type="url" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="https://" />
                    </div>
                    <div class="md:col-span-2">
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-motivo">Motivo del cambio</label>
                      <textarea id="presupuesto-motivo" rows="2" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Describe la modificación realizada"></textarea>
                    </div>
                    <div class="md:col-span-2">
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="presupuesto-observaciones">Observaciones</label>
                      <textarea id="presupuesto-observaciones" rows="2" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Notas internas opcionales"></textarea>
                    </div>
                    <div class="md:col-span-2 flex flex-wrap items-center justify-between gap-3">
                      <div class="text-xs text-[var(--text-secondary)]" id="presupuesto-form-status"></div>
                      <div class="flex gap-3">
                        <button type="submit" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                          <span class="material-icons text-base">save</span>
                          Guardar presupuesto
                        </button>
                        <button type="button" id="presupuesto-eliminar" class="hidden items-center gap-2 rounded-md border border-red-200 bg-white px-4 py-2 text-sm font-semibold text-red-500 shadow-sm transition hover:border-red-300 hover:text-red-600">
                          <span class="material-icons text-base">delete</span>
                          Eliminar
                        </button>
                      </div>
                    </div>
                  </form>
                </section>
              </div>
            </details>

            <details class="rounded-lg border border-gray-200 bg-white shadow-sm" id="panel-usuarios">
              <summary class="flex cursor-pointer select-none items-center justify-between gap-4 px-6 py-4 text-lg font-semibold text-[var(--text-primary)]">
                <div class="flex items-center gap-3">
                  <span class="material-icons text-indigo-500">group</span>
                  Administración de usuarios
                </div>
                <span class="material-icons chevron text-gray-500">chevron_right</span>
              </summary>
              <div class="border-t border-gray-100 p-6 space-y-6">
                <section class="space-y-4">
                  <div class="flex flex-wrap items-center justify-between gap-3">
                    <div>
                      <h2 class="text-xl font-semibold text-[var(--text-primary)]">Usuarios registrados</h2>
                      <p class="text-sm text-[var(--text-secondary)] max-w-2xl">
                        Gestiona las cuentas que pueden acceder al sistema. Las contraseñas se guardan con salt y hash
                        automáticamente al crear un nuevo usuario.
                      </p>
                    </div>
                    <button id="usuarios-recargar" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                      <span class="material-icons text-base">refresh</span>
                      Actualizar listado
                    </button>
                  </div>
                  <div class="flex flex-wrap items-center gap-3">
                    <label class="text-sm font-medium text-[var(--text-secondary)]" for="usuarios-buscar">Filtrar</label>
                    <input id="usuarios-buscar" type="search" placeholder="Por correo, rol o área" class="flex-1 min-w-[220px] rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    <span class="text-xs text-[var(--text-secondary)]" id="usuarios-resumen">0 usuarios</span>
                  </div>
                  <div class="overflow-x-auto rounded-lg border border-gray-200">
                    <table class="min-w-full divide-y divide-gray-200 text-sm" id="usuarios-tabla">
                      <thead class="bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500">
                        <tr>
                          <th class="px-3 py-2 text-left">Correo</th>
                          <th class="px-3 py-2 text-left">Rol</th>
                          <th class="px-3 py-2 text-left">Área</th>
                          <th class="px-3 py-2 text-left">Creado</th>
                          <th class="px-3 py-2 text-right">Acciones</th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-200 bg-white" id="usuarios-tabla-body">
                        <tr>
                          <td colspan="5" class="px-4 py-6 text-center text-sm text-gray-500">
                            Presiona "Actualizar listado" para cargar los usuarios registrados.
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </section>

                <section class="rounded-lg border border-gray-200 bg-gray-50 p-6">
                  <form id="usuarios-form" class="grid gap-4 md:grid-cols-2">
                    <div class="md:col-span-2 flex items-center justify-between">
                      <h3 class="text-lg font-semibold text-[var(--text-primary)]" id="usuario-form-titulo">Registrar nuevo usuario</h3>
                      <button type="button" id="usuario-limpiar" class="flex items-center gap-2 rounded-md border border-transparent px-3 py-1.5 text-xs font-medium text-gray-500 hover:text-indigo-600">
                        <span class="material-icons text-base">restart_alt</span>
                        Limpiar
                      </button>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="usuario-email">Correo institucional</label>
                      <input id="usuario-email" name="email" type="email" required class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="usuario@gestiondelriesgo.gov.co" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="usuario-password">Contraseña temporal</label>
                      <input id="usuario-password" name="password" type="password" minlength="8" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Debe compartirse por canal seguro" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="usuario-rol">Rol</label>
                      <select id="usuario-rol" name="role" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="admin">Administrador</option>
                        <option value="contribuidor" selected>Contribuidor</option>
                        <option value="visualizador">Visualizador</option>
                      </select>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="usuario-area">Área</label>
                      <select id="usuario-area" name="area" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="">Sin área (opcional)</option>
                      </select>
                    </div>
                    <div class="md:col-span-2 text-xs text-[var(--text-secondary)]">
                      La contraseña ingresada se almacenará de forma segura usando salt y hash. Comparte la clave temporal
                      por un canal seguro y solicita al usuario cambiarla posteriormente.
                    </div>
                    <div class="md:col-span-2 flex flex-wrap items-center justify-between gap-3">
                      <div class="text-xs text-[var(--text-secondary)]" id="usuario-form-status"></div>
                      <div class="flex gap-3">
                        <button type="submit" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                          <span class="material-icons text-base">person_add</span>
                          Registrar usuario
                        </button>
                      </div>
                    </div>
                  </form>
                </section>
              </div>
            </details>

            <details class="rounded-lg border border-gray-200 bg-white shadow-sm" id="panel-actividades">
              <summary class="flex cursor-pointer select-none items-center justify-between gap-4 px-6 py-4 text-lg font-semibold text-[var(--text-primary)]">
                <div class="flex items-center gap-3">
                  <span class="material-icons text-indigo-500">fact_check</span>
                  Administración de actividades
                </div>
                <span class="material-icons chevron text-gray-500">chevron_right</span>
              </summary>
              <div class="border-t border-gray-100 p-6 space-y-6">
                <section class="space-y-4">
                  <div class="flex flex-wrap items-center justify-between gap-3">
                    <div>
                      <h2 class="text-xl font-semibold text-[var(--text-primary)]">Actividades registradas</h2>
                      <p class="text-sm text-[var(--text-secondary)]">Busca, edita o desactiva actividades del plan sin salir de este panel.</p>
                    </div>
                    <button id="actividades-recargar" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                      <span class="material-icons text-base">refresh</span>
                      Actualizar listado
                    </button>
                  </div>
                  <div class="flex flex-wrap items-center gap-3">
                    <label class="text-sm font-medium text-[var(--text-secondary)]" for="actividades-buscar">Filtrar</label>
                    <input id="actividades-buscar" type="search" placeholder="Por descripción, área o estado" class="flex-1 min-w-[220px] rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    <span class="text-xs text-[var(--text-secondary)]" id="actividades-resumen">0 actividades</span>
                  </div>
                  <div class="overflow-x-auto rounded-lg border border-gray-200">
                    <table class="min-w-full divide-y divide-gray-200 text-sm" id="actividades-tabla">
                      <thead class="bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500">
                        <tr>
                          <th class="px-3 py-2 text-left">Código</th>
                          <th class="px-3 py-2 text-left">Descripción</th>
                          <th class="px-3 py-2 text-left">Área</th>
                          <th class="px-3 py-2 text-left">Estado</th>
                          <th class="px-3 py-2 text-left">Responsable</th>
                          <th class="px-3 py-2 text-right">Acciones</th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-200 bg-white" id="actividades-tabla-body">
                        <tr>
                          <td colspan="6" class="px-4 py-6 text-center text-sm text-gray-500">
                            Presiona "Actualizar listado" para cargar las actividades.
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </section>

                <section class="rounded-lg border border-gray-200 bg-gray-50 p-6">
                  <form id="actividades-form" class="grid gap-4 md:grid-cols-2">
                    <input type="hidden" id="actividad-id" />
                    <div class="md:col-span-2 flex items-center justify-between">
                      <h3 class="text-lg font-semibold text-[var(--text-primary)]" id="actividad-form-titulo">Editar actividad seleccionada</h3>
                      <div class="flex gap-2">
                        <button type="button" id="actividad-limpiar" class="flex items-center gap-2 rounded-md border border-transparent px-3 py-1.5 text-xs font-medium text-gray-500 hover:text-indigo-600">
                          <span class="material-icons text-base">restart_alt</span>
                          Limpiar
                        </button>
                        <a href="./actividades.html" target="_blank" class="inline-flex items-center gap-2 rounded-md border border-gray-200 px-3 py-1.5 text-xs font-semibold text-[var(--primary-color)] transition hover:border-indigo-300">
                          <span class="material-icons text-base">open_in_new</span>
                          Abrir gestor completo
                        </a>
                      </div>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="actividad-codigo">Código</label>
                      <input id="actividad-codigo" name="actividad_id" type="text" readonly class="mt-1 w-full rounded-md border-gray-200 bg-gray-100 text-sm shadow-sm" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="actividad-estado">Estado</label>
                      <select id="actividad-estado" name="estado" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        <option value="">Selecciona estado</option>
                        <option value="Planeada">Planeada</option>
                        <option value="En Progreso">En Progreso</option>
                        <option value="Completada">Completada</option>
                        <option value="Suspendida">Suspendida</option>
                        <option value="Cancelada">Cancelada</option>
                      </select>
                    </div>
                    <div class="md:col-span-2">
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="actividad-descripcion">Descripción</label>
                      <textarea id="actividad-descripcion" name="descripcion_actividad" rows="3" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="actividad-meta">Meta anual</label>
                      <input id="actividad-meta" name="meta" type="text" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="actividad-responsable">Responsable</label>
                      <input id="actividad-responsable" name="responsable" type="text" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div class="md:col-span-2">
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="actividad-detalle">Datos completos (JSON opcional)</label>
                      <textarea id="actividad-detalle" name="raw" rows="4" class="mt-1 w-full rounded-md border-gray-300 text-sm font-mono shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Pegue aquí la etiqueta completa si necesita enviar campos adicionales"></textarea>
                    </div>
                    <div class="md:col-span-2 flex flex-wrap items-center justify-between gap-3">
                      <div class="text-xs text-[var(--text-secondary)]" id="actividad-form-status"></div>
                      <div class="flex gap-3">
                        <button type="submit" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                          <span class="material-icons text-base">save</span>
                          Guardar cambios
                        </button>
                        <button type="button" id="actividad-eliminar" class="hidden items-center gap-2 rounded-md border border-red-200 bg-white px-4 py-2 text-sm font-semibold text-red-500 shadow-sm transition hover:border-red-300 hover:text-red-600">
                          <span class="material-icons text-base">delete</span>
                          Eliminar actividad
                        </button>
                      </div>
                    </div>
                  </form>
                </section>
              </div>
            </details>

            <details class="rounded-lg border border-gray-200 bg-white shadow-sm" id="panel-avances">
              <summary class="flex cursor-pointer select-none items-center justify-between gap-4 px-6 py-4 text-lg font-semibold text-[var(--text-primary)]">
                <div class="flex items-center gap-3">
                  <span class="material-icons text-indigo-500">trending_up</span>
                  Seguimiento de avances
                </div>
                <span class="material-icons chevron text-gray-500">chevron_right</span>
              </summary>
              <div class="border-t border-gray-100 p-6 space-y-6">
                <section class="space-y-4">
                  <div class="flex flex-wrap items-center justify-between gap-3">
                    <div>
                      <h2 class="text-xl font-semibold text-[var(--text-primary)]">Registros de avance</h2>
                      <p class="text-sm text-[var(--text-secondary)]">Consulta y corrige reportes individuales enviados por los equipos.</p>
                    </div>
                    <button id="avances-recargar" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                      <span class="material-icons text-base">refresh</span>
                      Actualizar listado
                    </button>
                  </div>
                  <div class="flex flex-wrap items-center gap-3">
                    <label class="text-sm font-medium text-[var(--text-secondary)]" for="avances-buscar">Filtrar</label>
                    <input id="avances-buscar" type="search" placeholder="Por actividad, responsable o estado" class="flex-1 min-w-[220px] rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    <span class="text-xs text-[var(--text-secondary)]" id="avances-resumen">0 registros</span>
                  </div>
                  <div class="overflow-x-auto rounded-lg border border-gray-200">
                    <table class="min-w-full divide-y divide-gray-200 text-sm" id="avances-tabla">
                      <thead class="bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500">
                        <tr>
                          <th class="px-3 py-2 text-left">ID</th>
                          <th class="px-3 py-2 text-left">Código actividad</th>
                          <th class="px-3 py-2 text-left">Actividad</th>
                          <th class="px-3 py-2 text-left">Bimestre</th>
                          <th class="px-3 py-2 text-left">Responsable</th>
                          <th class="px-3 py-2 text-left">Fecha</th>
                          <th class="px-3 py-2 text-right">Acciones</th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-200 bg-white" id="avances-tabla-body"></tbody>
                    </table>
                  </div>
                </section>

                <section class="rounded-lg border border-gray-200 bg-gray-50 p-6">
                  <form id="avances-form" class="grid gap-4 md:grid-cols-2">
                    <input type="hidden" id="avance-id" />
                    <div class="md:col-span-2 flex items-center justify-between">
                      <h3 class="text-lg font-semibold text-[var(--text-primary)]" id="avance-form-titulo">Editar avance seleccionado</h3>
                      <div class="flex gap-2">
                        <button type="button" id="avance-limpiar" class="flex items-center gap-2 rounded-md border border-transparent px-3 py-1.5 text-xs font-medium text-gray-500 hover:text-indigo-600">
                          <span class="material-icons text-base">restart_alt</span>
                          Limpiar
                        </button>
                        <a href="./avance.html" target="_blank" class="inline-flex items-center gap-2 rounded-md border border-gray-200 px-3 py-1.5 text-xs font-semibold text-[var(--primary-color)] transition hover:border-indigo-300">
                          <span class="material-icons text-base">open_in_new</span>
                          Abrir panel de avances
                        </a>
                      </div>
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="avance-actividad">Actividad</label>
                      <input id="avance-actividad" name="actividad_id" type="text" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="avance-bimestre">Bimestre</label>
                      <input id="avance-bimestre" name="bimestre_id" type="text" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="avance-fecha">Fecha de reporte</label>
                      <input id="avance-fecha" name="fecha_reporte" type="date" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div>
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="avance-reportado">Reportado por</label>
                      <input id="avance-reportado" name="reportado_por" type="email" class="mt-1 w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
                    </div>
                    <div class="md:col-span-2">
                      <label class="block text-xs font-semibold uppercase tracking-wide text-[var(--text-secondary)]" for="avance-detalle">Detalle (JSON)</label>
                      <textarea id="avance-detalle" name="raw" rows="4" class="mt-1 w-full rounded-md border-gray-300 text-sm font-mono shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Incluye progresso, dificultades u otra información adicional"></textarea>
                    </div>
                    <div class="md:col-span-2 flex flex-wrap items-center justify-between gap-3">
                      <div class="text-xs text-[var(--text-secondary)]" id="avance-form-status"></div>
                      <div class="flex gap-3">
                        <button type="submit" class="inline-flex items-center gap-2 rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-600">
                          <span class="material-icons text-base">save</span>
                          Guardar avance
                        </button>
                        <button type="button" id="avance-eliminar" class="hidden items-center gap-2 rounded-md border border-red-200 bg-white px-4 py-2 text-sm font-semibold text-red-500 shadow-sm transition hover:border-red-300 hover:text-red-600">
                          <span class="material-icons text-base">delete</span>
                          Eliminar avance
                        </button>
                      </div>
                    </div>
                  </form>
                </section>
              </div>
            </details>
          </div>
        </main>
      </div>
    </div>
  </div>

  <script type="module" src="../lib/session-guard.js"></script>
  <script type="module" src="../lib/sidebar-component.js"></script>
  <script type="module" src="../lib/loader.js"></script>
  <script type="module" src="../pages_scripts/admin.js"></script>
</body>
</html>


